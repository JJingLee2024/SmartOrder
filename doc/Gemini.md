# SmartOrder Gemini API 整合指南 (AI-to-AI / PM Reference)

本文件說明 SmartOrder MVP 中如何利用 Google Gemini 進行餐廳管理流程的自動化。

## 1. 核心模型資訊
- **模型版本**: `gemini-3-flash-preview`
- **選擇理由**: 提供極高的解析速度（低延遲）與強大的多模態（Multimodal）處理能力，適合即時解析紙本菜單影像，且成本效益比最高。

## 2. 目前整合場景：AI 菜單解析 (Menu Intelligence)
當使用者在 `MenuView` 上傳圖片時，系統會調用 `geminiService.ts`。

### A. 輸入 (Input)
- **視覺數據**: 使用者拍攝的紙本菜單 Base64 影像。
- **上下文**: 店鋪名稱 (Contextually injected shop name)。

### B. 提示詞工程 (Prompt Engineering)
系統使用以下指令引導模型：
> 「你是一位專業的餐廳點餐系統助理。請解析以下菜單圖片，並整理成 JSON 格式。包含菜品分類、菜名、價格。店鋪名稱為：{shopName}」

### C. 結構化輸出 (Structured Output)
利用 `responseSchema` 強制模型輸出符合系統 `ShopMenu` 類型的 JSON 格式：
- `brandName`: 品牌名稱。
- `categories`: 菜品分類陣列。
- `items`: 包含 `name`, `price`, `category` 的對象陣列。

## 3. 未來擴展計畫 (Product Roadmap for AI)

### A. 營運數據分析 (Reporting & Insights)
- **邏輯**: 餵入預訂紀錄與訂單歷史。
- **目標**: 生成經營週報，例如：「週五晚間現場客佔比 70%，建議增加外場人力」或「牛肉麵點餐率下滑，建議推出組合餐」。

### B. 客服機器人 (Live API Interaction)
- **技術**: 利用 `gemini-2.5-flash-native-audio-preview`。
- **目標**: 支援語音訂位，AI 能直接與客戶對話並透過 Function Calling 寫入 `dataService` 的預訂紀錄。

### C. 菜單優化建議
- **邏輯**: 結合 Google Search Grounding。
- **目標**: 根據當前地區流行趨勢，建議店主調整價格或新增熱門品項（如：近期流行抹茶，建議新增抹茶飲品）。

## 4. 技術實作備註
- **安全性**: API Key 透過環境變數 `process.env.API_KEY` 注入，不應硬編碼於代碼中。
- **容錯處理**: 若圖片解析失敗或 API 限制，系統內建 Fallback 模擬數據以維持使用者流程 (User Flow) 的連貫性。

---
*Generated by SmartOrder Engineering Team*